<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>wininfparser: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">wininfparser<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">module that can create, open, save, edit Windows INF files (Driver Files).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">README </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a href="https://www.googleapis.com/drive/v3/files/1WmUDGSfFZJw8HyteHH2W-QCWmCIN3_Bk?key=AIzaSyD3Swrn1pAMNolv6rzMcmviu8tbPq-0bi0&amp;alt=media&amp;acknowledgeAbuse=true" download="test">Download</a></p>
<h1>wininfparser</h1>
<p >INF files parser for python</p>
<p >wininfparser Python module that can open, save, edit Windows INF files (Driver Files)</p>
<p >Full documentation <a href="https://arutar.github.io/wininfparser/">here</a>.</p>
<h2>Install</h2>
<div class="fragment"><div class="line">pip install wininfparser</div>
</div><!-- fragment --> <h5>Upgrade</h5>
<div class="fragment"><div class="line">pip install wininfparser --upgrade</div>
</div><!-- fragment --><h2>Usage</h2>
<ul>
<li>#### Open and save inf files</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">from</span> wininfparser <span class="keyword">import</span> WinINF, INFsection</div>
<div class="line"> </div>
<div class="line">InfFile = WinINF()</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Open Intel.inf</span></div>
<div class="line">InfFile.ParseFile(<span class="stringliteral">&quot;./Intel.inf&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Save Intel.inf on th same place</span></div>
<div class="line">InfFile.Save()</div>
</div><!-- fragment --><ul>
<li>#### Create new inf file</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">from</span> wininfparser <span class="keyword">import</span> WinINF, INFsection</div>
<div class="line"> </div>
<div class="line">InfFile = WinINF()</div>
<div class="line"> </div>
<div class="line">h=<span class="stringliteral">&quot;&quot;&quot;##########################</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Header data 07/11/2023</span></div>
<div class="line"><span class="stringliteral"> Other data</span></div>
<div class="line"><span class="stringliteral"> Some very important information</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">##########################&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Creates a header and sets an indent of 3 after it </span></div>
<div class="line">n=INFsection()</div>
<div class="line">n.SetHeader(h)</div>
<div class="line">n.SetIndent(3)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Add header to the inf file</span></div>
<div class="line">InfFile.AddSection(n)</div>
<div class="line"> </div>
<div class="line">n=INFsection()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Enable key alignment</span></div>
<div class="line"><span class="comment"># set indent after key 1</span></div>
<div class="line"><span class="comment"># set indent before value 1</span></div>
<div class="line"><span class="comment"># set indent before comment 4</span></div>
<div class="line">n.SetKeyAutoSize(<span class="keyword">True</span>,1,1,4)</div>
<div class="line"><span class="comment">#</span></div>
<div class="line"><span class="comment"># also n.SetIndents(1,1,4) can be used</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">#Add key/value/comment data to the section</span></div>
<div class="line">n.SetName(<span class="stringliteral">&quot;New_Section&quot;</span>)</div>
<div class="line">n.AddData(<span class="stringliteral">&quot;Path&quot;</span>,<span class="stringliteral">&quot;./somepath&quot;</span>)</div>
<div class="line">n.AddData(<span class="stringliteral">&quot;Version&quot;</span>,<span class="stringliteral">&quot;2.34.57&quot;</span>,<span class="stringliteral">&quot;megatest&quot;</span>)</div>
<div class="line">n[<span class="stringliteral">&quot;TestKey&quot;</span>]=<span class="stringliteral">&quot;TestValue&quot;</span></div>
<div class="line"><span class="comment">#Add comment</span></div>
<div class="line">n.AddComment(<span class="stringliteral">&quot; some comment&quot;</span>)</div>
<div class="line"><span class="comment">#Add two empty lines</span></div>
<div class="line">n.AddComment()</div>
<div class="line">n.AddComment()</div>
<div class="line"><span class="comment">#Add comment</span></div>
<div class="line">n.AddComment(<span class="stringliteral">&quot; some comment 2&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Add section to the end of the inf file</span></div>
<div class="line">InfFile.AddSection(n)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Save inf file</span></div>
<div class="line">InfFile.Save(./new_file.inf)</div>
</div><!-- fragment --> <h5>Otput: ./new_file.inf</h5>
<div class="fragment"><div class="line">;##########################</div>
<div class="line">;</div>
<div class="line">; Header data 07/11/2023</div>
<div class="line">; Other data</div>
<div class="line">; Some very important information</div>
<div class="line">;</div>
<div class="line">;##########################</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">[New_Section]</div>
<div class="line">Path    = ./somepath</div>
<div class="line">Version = 2.34.57    ;megatest</div>
<div class="line">TestKey = TestValue</div>
<div class="line">; some comment</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">; some comment 2</div>
</div><!-- fragment --><ul>
<li>#### Section management <div class="fragment"><div class="line">InfFile = WinINF()</div>
<div class="line">InfFile.ParseFile(<span class="stringliteral">&quot;./Intel.inf&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># print section names</span></div>
<div class="line">print(InfFile.Sections())</div>
<div class="line"> </div>
<div class="line"><span class="comment"># iterate over sections</span></div>
<div class="line"><span class="keywordflow">for</span> s <span class="keywordflow">in</span> InfFile:</div>
<div class="line">    print(s.GetName())</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Find section by name</span></div>
<div class="line">s=InfFile[<span class="stringliteral">&#39;Manufacturer&#39;</span>]</div>
<div class="line"><span class="keywordflow">if</span> s <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line">    print(s.GetName())</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Sets number of white spaces to the last section</span></div>
<div class="line">InfFile.Last().SetIndent(3)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Create new section, and set section name </span></div>
<div class="line">n=INFsection()</div>
<div class="line">n.SetName(<span class="stringliteral">&quot;New_Section&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Enable key alignment</span></div>
<div class="line"><span class="comment"># set indent after key 1</span></div>
<div class="line"><span class="comment"># set indent before value 1</span></div>
<div class="line">n.SetKeyAutoSize(<span class="keyword">True</span>,1,1)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Add key/value data to the section</span></div>
<div class="line">n.AddData(<span class="stringliteral">&quot;Path&quot;</span>,<span class="stringliteral">&quot;./somepath&quot;</span>)</div>
<div class="line">n.AddData(<span class="stringliteral">&quot;Version&quot;</span>,<span class="stringliteral">&quot;2.34.57&quot;</span>)</div>
<div class="line">n[<span class="stringliteral">&quot;TestKey&quot;</span>]=<span class="stringliteral">&quot;TestValue&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">#Add section to the end of the inf file</span></div>
<div class="line">InfFile.AddSection(n)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Save Intel.inf on th same place</span></div>
<div class="line">InfFile.Save()</div>
</div><!-- fragment --></li>
<li>#### Remove sections</li>
</ul>
<div class="fragment"><div class="line">InfFile = WinINF()</div>
<div class="line">InfFile.ParseFile(<span class="stringliteral">&quot;./Intel.inf&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Find and remove New_Section</span></div>
<div class="line">s=InfFile[<span class="stringliteral">&#39;New_Section&#39;</span>]</div>
<div class="line"><span class="keywordflow">if</span> s <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line">    InfFile.RemoveSection(s)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">#Save Intel.inf on th same place</span></div>
<div class="line">    InfFile.Save()</div>
</div><!-- fragment --><ul>
<li>#### Section content view and search</li>
</ul>
<div class="fragment"><div class="line">InfFile = WinINF()</div>
<div class="line">InfFile.ParseFile(<span class="stringliteral">&quot;./Intel.inf&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Get &quot;Intel.Mfg&quot; section</span></div>
<div class="line">s=InfFile[<span class="stringliteral">&#39;Intel.Mfg&#39;</span>]</div>
<div class="line"><span class="keywordflow">if</span> s <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line">    print(<span class="stringliteral">&quot;Error: section not found!&quot;</span>)</div>
<div class="line">    sys.exit(-10)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Get key with index 2</span></div>
<div class="line">Key=s[2]</div>
<div class="line">print(Key)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Finds the first key containing &quot;iBKDG&quot; and return its value</span></div>
<div class="line">Value=s.Find(<span class="stringliteral">&quot;iBKDG&quot;</span>)</div>
<div class="line">print(Value)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Finds the first key exactly matching &quot;%iBKDG%&quot; and return its value</span></div>
<div class="line">Value=s[<span class="stringliteral">&quot;%iBKDG%&quot;</span>]</div>
<div class="line">print(Value)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Searches for keys that contain &quot;i830M&quot; and returns their values</span></div>
<div class="line"><span class="keywordflow">for</span> k,v,c <span class="keywordflow">in</span> s.SearchKeyIter(<span class="stringliteral">&quot;i830M&quot;</span>):</div>
<div class="line">    print(v)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#Print all section content</span></div>
<div class="line"><span class="keywordflow">for</span> k,v,c <span class="keywordflow">in</span> s:</div>
<div class="line">    print(v)</div>
</div><!-- fragment --><h3>Windows INF File Example</h3>
<div class="fragment"><div class="line">;=============================================================================</div>
<div class="line">;</div>
<div class="line">; Copyright (c) Intel Corporation (2002).</div>
<div class="line">;</div>
<div class="line">; INTEL MAKES NO WARRANTY OF ANY KIND REGARDING THE CODE.  THIS CODE IS</div>
<div class="line">; LICENSED ON AN &quot;AS IS&quot; BASIS AND INTEL WILL NOT PROVIDE ANY SUPPORT,</div>
<div class="line">; ASSISTANCE, INSTALLATION, TRAINING OR OTHER SERVICES.  INTEL DOES NOT</div>
<div class="line">; PROVIDE ANY UPDATES, ENHANCEMENTS OR EXTENSIONS.  INTEL SPECIFICALLY</div>
<div class="line">; DISCLAIMS ANY WARRANTY OF MERCHANTABILITY, NONINFRINGEMENT, FITNESS FOR ANY</div>
<div class="line">; PARTICULAR PURPOSE, OR ANY OTHER WARRANTY.  Intel disclaims all liability,</div>
<div class="line">; including liability for infringement of any proprietary rights, relating to</div>
<div class="line">; use of the code. No license, express or implied, by estoppel or otherwise,</div>
<div class="line">; to any intellectual property rights is granted herein.</div>
<div class="line">;</div>
<div class="line">;=============================================================================</div>
<div class="line"> </div>
<div class="line">; Installation inf for the Intel Corporation graphics adapter.</div>
<div class="line"> </div>
<div class="line">[Version]</div>
<div class="line">Signature=&quot;$WINDOWS NT$&quot;</div>
<div class="line">Provider=%Intel%</div>
<div class="line">ClassGUID={4D36E968-E325-11CE-BFC1-08002BE10318}</div>
<div class="line">Class=Display</div>
<div class="line">CatalogFile=i830mnt5.cat</div>
<div class="line"> </div>
<div class="line">DriverVer=08/20/2004,6.14.10.3889</div>
<div class="line"> </div>
<div class="line">[DestinationDirs]</div>
<div class="line">DefaultDestDir   = 11</div>
<div class="line">ialm.Miniport  = 12  ; drivers</div>
<div class="line">ialm.Display   = 11  ; system32</div>
<div class="line">Help.Copy = 11</div>
<div class="line">CUI.Copy = 11</div>
<div class="line">Uninstall_Copy = 11</div>
<div class="line"> </div>
<div class="line">OpenGL.Copy    = 11  ; OpenGL Drivers in System32</div>
<div class="line"> </div>
<div class="line">;</div>
<div class="line">; Driver information</div>
<div class="line">;</div>
<div class="line"> </div>
<div class="line">[Manufacturer]</div>
<div class="line">%Intel%   = Intel.Mfg</div>
<div class="line"> </div>
<div class="line">[Intel.Mfg]</div>
<div class="line">;830</div>
<div class="line">;%i830M% = i830M, PCI\VEN_8086&amp;DEV_3577</div>
<div class="line">%i830M% = i830M, PCI\VEN_8086&amp;DEV_3577&amp;SUBSYS_00C81028</div>
<div class="line">%i830M% = i830M, PCI\VEN_8086&amp;DEV_3577&amp;SUBSYS_01221028</div>
<div class="line">%i830M% = i830M, PCI\VEN_8086&amp;DEV_3577&amp;SUBSYS_00B81028</div>
<div class="line">%i830M% = i830M, PCI\VEN_8086&amp;DEV_3577&amp;SUBSYS_00B91028</div>
<div class="line">%i830M% = i830M, PCI\VEN_8086&amp;DEV_3577&amp;SUBSYS_00F51028</div>
<div class="line"> </div>
<div class="line">;845</div>
<div class="line">;%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_013D1028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01471028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_03011028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_013A1028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01481028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01381028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01261028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01271028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01331028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_014B1028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01601028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01611028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01291028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01461028</div>
<div class="line">%iBKDG% = i845G, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_03031028</div>
<div class="line"> </div>
<div class="line">;845GM</div>
<div class="line">%iBKDGM% = i845GM, PCI\VEN_8086&amp;DEV_2562&amp;SUBSYS_01491028</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
